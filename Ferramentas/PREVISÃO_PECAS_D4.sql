-- LISTAGEM COM DIVERSAS INFORMAÇÕES DA PROGRAMAÇÃO DE CAMES  PARA O MÊS -----------------------------------------------------------

SELECT						--
	D4_COD AS Produto,
	B1.B1_DESC AS DESCRIÇÃO,
	D4_LOCAL AS Armazem,
	LEFT (D4_OP, LEN(D4_OP)-5) AS NUMERO_OP,
	D4_DATA AS DT_Empenho,
	D4_QTDEORI AS Qtd_Empenho,
	D4_PRODUTO AS Produto_Pai,
	--B2.B1_DESC AS DESCRIÇÃO_PAI,
	B1.B1_GRUPO AS Grupo

	FROM 
		SD4010 D 

		INNER JOIN SB1010 B2 ON D4_PRODUTO = B1_COD

		INNER JOIN SB1010 B1 ON	D4_COD = B1.B1_COD


	WHERE B1.B1_GRUPO = '021N' AND --CAMPO A SER ALTERADO CONFORME O GRUPO A SER PESQUISADO--
		LEFT (D4_OP, LEN(D4_OP)-5) IN
		( 'A00ZXE','A00ZXF','A00ZXG','A00ZXH','A00ZXI','A00ZXJ','A00ZXK','A00ZXL','A00ZXM','A00ZXP','A00ZXQ','A00ZXR','A00ZXS','A00ZXT','A00ZXU','A01243','A01183') --OPS DE JANEIRO--
		AND	b1.D_E_L_E_T_ <> '*'


-- SOMA DO EMPENHO DE TODAS AS PEÇAS LISTADAS PARA O MÊS----------------------------------------------------------------------------

SELECT A.PRODUTO
	, G1_COMP AS SEMI_ACABADO
	, B1_GRUPO
	, a.DESCRIÇÃO
	, NUMERO_OP
	, SUM(A.Qtd_Empenho)as QNT_TOTAL
	, CASE
		WHEN A.NUMERO_OP IN ('A00ZSQ', 'A00Z29', 'A00Z30', 'A00ZWG', 'A00ZWI', 'A00ZXA', 'A00ZXB', 'A00ZXC', 'A00ZXD', 
							'A00ZEI', 'A00ZUT', 'A00ZUU', 'A01184', 'A00ZWJ', 'A00ZWK') THEN 'SET'

		WHEN A.NUMERO_OP IN ('A00ZLL', 'A00ZLM', 'A00ZLN', 'A00ZXZ', 'A00ZY0', 'A00ZQ0', 'A00ZV3', 'A00ZYS', 'A00ZYT',
								'A00ZYU', 'A00ZY4', 'A00ZZD', 'A01166', 'A01167', 'A01174', 'A01175', 'A01177', 'A01171') THEN 'OUT' 

		WHEN A.NUMERO_OP IN ('A00ZXE', 'A00ZXF', 'A00ZXG', 'A00ZXH', 'A00ZXI', 'A00ZXJ', 'A00ZXK', 'A00ZXL', 'A00ZXM',
								'A00ZXP', 'A00ZXQ','A00ZXR', 'A00ZXS', 'A00ZXT', 'A00ZXU', 'A01243', 'A01183') THEN 'NOV'

		WHEN a.NUMERO_OP IN ( 'A00ZWW', 'A00ZWX', 'A00ZWY', 'A01051') THEN 'DEZ'
		ELSE '0'
		END ENTREGA
	FROM
		(SELECT						--
			D4_COD AS Produto,
			B1.B1_DESC AS DESCRIÇÃO,
			D4_LOCAL AS Armazem,
			LEFT (D4_OP, LEN(D4_OP)-5) AS NUMERO_OP,
			D4_DATA AS DT_Empenho,
			D4_QTDEORI AS Qtd_Empenho,
			D4_PRODUTO AS Produto_Pai,
			--B2.B1_DESC AS DESCRIÇÃO_PAI,
			B1.B1_GRUPO AS Grupo
			FROM SD4010 D 

			INNER JOIN SB1010 B2 ON D4_PRODUTO = B1_COD

			INNER JOIN SB1010 B1 ON	D4_COD = B1.B1_COD

			WHERE B1.B1_GRUPO = '032N' AND
				LEFT (D4_OP, LEN(D4_OP)-5) IN
					( 'A00ZSQ', 'A00Z29', 'A00Z30', 'A00ZWG', 'A00ZWI', 'A00ZXA', 'A00ZXB', 'A00ZXC', 'A00ZXD','A00ZEI', 'A00ZUT', 'A00ZUU',
					'A01184', 'A00ZWJ', 'A00ZWK''A00ZLL', 'A00ZLM', 'A00ZLN', 'A00ZXZ', 'A00ZY0', 'A00ZQ0', 'A00ZV3', 'A00ZYS', 'A00ZYT', 
					'A00ZYU', 'A00ZY4', 'A00ZZD','A01166', 'A01167', 'A01174', 'A01175', 'A01177', 'A01171', 'A00ZXE', 'A00ZXF', 'A00ZXG', 
					'A00ZXH', 'A00ZXI', 'A00ZXJ', 'A00ZXK', 'A00ZXL', 'A00ZXM', 'A00ZXP', 'A00ZXQ', 'A00ZXR', 'A00ZXS', 'A00ZXT', 'A00ZXU', 
					'A01243', 'A01183', 'A00ZWW', 'A00ZWX', 'A00ZWY', 'A01051')
				AND	b1.D_E_L_E_T_ <> '*') A
		INNER JOIN SG1010 ON Produto = G1_COD AND SG1010.D_E_L_E_T_<>'*'
		INNER JOIN SB1010 ON B1_COD = G1_COMP AND SB1010.D_E_L_E_T_<>'*'

	WHERE
		G1_COMP NOT LIKE 'B%'
		AND B1_GRUPO = '032'
	GROUP BY 
		a.NUMERO_OP, 
		G1_COMP,
		a.Produto,
		a.DESCRIÇÃO, 
		B1_GRUPO

	ORDER BY SUM(a.Qtd_Empenho) DESC

-------------------------------------------------------------------------------------------------------

SELECT						--
		D4_COD AS Produto,
		G1_COMP,
		B1.B1_DESC AS DESCRIÇÃO,
		D4_LOCAL AS Armazem,
		LEFT (D4_OP, LEN(D4_OP)-5) AS NUMERO_OP,
		D4_DATA AS DT_Empenho,
		D4_QTDEORI AS Qtd_Empenho,
		D4_PRODUTO AS Produto_Pai,
		--B2.B1_DESC AS DESCRIÇÃO_PAI,
		B1.B1_GRUPO AS Grupo,
		CASE
		WHEN LEFT (D4_OP, LEN(D4_OP)-5) IN ('A00ZSQ', 'A00Z29', 'A00Z30', 'A00ZWG', 'A00ZWI', 'A00ZXA', 'A00ZXB', 'A00ZXC', 'A00ZXD', 
							'A00ZEI', 'A00ZUT', 'A00ZUU', 'A01184', 'A00ZWJ', 'A00ZWK') THEN 'SET'

		WHEN LEFT (D4_OP, LEN(D4_OP)-5) IN ('A00ZLL', 'A00ZLM', 'A00ZLN', 'A00ZXZ', 'A00ZY0', 'A00ZQ0', 'A00ZV3', 'A00ZYS', 'A00ZYT',
								'A00ZYU', 'A00ZY4', 'A00ZZD', 'A01166', 'A01167', 'A01174', 'A01175', 'A01177', 'A01171') THEN 'OUT' 

		WHEN LEFT (D4_OP, LEN(D4_OP)-5) IN ('A00ZXE', 'A00ZXF', 'A00ZXG', 'A00ZXH', 'A00ZXI', 'A00ZXJ', 'A00ZXK', 'A00ZXL', 'A00ZXM',
								'A00ZXP', 'A00ZXQ','A00ZXR', 'A00ZXS', 'A00ZXT', 'A00ZXU', 'A01243', 'A01183') THEN 'NOV'

		WHEN LEFT (D4_OP, LEN(D4_OP)-5) IN ( 'A00ZWW', 'A00ZWX', 'A00ZWY', 'A01051') THEN 'DEZ'
		ELSE '0'
		END ENTREGA
		FROM SD4010 D 

		INNER JOIN SB1010 B2 ON D4_PRODUTO = B1_COD

		INNER JOIN SB1010 B1 ON	D4_COD = B1.B1_COD

		INNER JOIN SG1010 ON D4_COD = G1_COD AND SG1010.D_E_L_E_T_<>'*'

		WHERE B1.B1_GRUPO = '032N' AND
			LEFT (D4_OP, LEN(D4_OP)-5) IN
				( 'A00ZSQ', 'A00Z29', 'A00Z30', 'A00ZWG', 'A00ZWI', 'A00ZXA', 'A00ZXB', 'A00ZXC', 'A00ZXD','A00ZEI', 'A00ZUT', 'A00ZUU',
				'A01184', 'A00ZWJ', 'A00ZWK','A00ZLL', 'A00ZLM', 'A00ZLN', 'A00ZXZ', 'A00ZY0', 'A00ZQ0', 'A00ZV3', 'A00ZYS', 'A00ZYT', 
				'A00ZYU', 'A00ZY4', 'A00ZZD','A01166', 'A01167', 'A01174', 'A01175', 'A01177', 'A01171', 'A00ZXE', 'A00ZXF', 'A00ZXG', 
				'A00ZXH', 'A00ZXI', 'A00ZXJ', 'A00ZXK', 'A00ZXL', 'A00ZXM', 'A00ZXP', 'A00ZXQ', 'A00ZXR', 'A00ZXS', 'A00ZXT', 'A00ZXU', 
				'A01243', 'A01183', 'A00ZWW', 'A00ZWX', 'A00ZWY', 'A01051')
			AND	b1.D_E_L_E_T_ <> '*'


SELECT *FROM SD4010 WHERE LEFT (D4_OP, LEN(D4_OP)-5) IN ('A00ZSQ')



SELECT * FROM SC2010